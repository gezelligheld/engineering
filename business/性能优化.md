下面从几个角度来聊一下前端性能优化

#### 网络层面

从输入 url 到显示页面的过程中，涉及到网络相关的主要有以下几个部分

- DNS 解析
- TCP 连接
- HTTP 请求/响应

对于 DNS 解析和 TCP 连接，前端能做的优化非常有限，http 的请求和响应才是前端优化的重点，主要又分为以下两点

- 减少请求次数
- 减少单次请求所花费的时间

##### 减少请求次数

- 只请求当前需要的资源，例如异步的路由加载、图片懒加载、polyfill 动态加载等。用于 polyfill 的包一般比较大，可以通过以下的 cdn 去根据当前浏览器版本动态引入 polyfill

- 单独的 chunk 不宜过小，小于 10kb 的 chunk 尽量合并，也不能过大，否则单次请求会很耗时

##### 减少单次请求所花费的时间

- 减小资源体积，webpack 内置了对 js、css 的压缩处理，tree-shaking 都有效的减小了产出体积

- 开启 gzip 压缩

gzip 是 http 压缩的一种方式，使用后 http 数据被服务端压缩然后发送给客户端，客户端在进行相应的解压，一般会减小响应 70%左右的大小，request header 中添加一下配置就可以开启

```
accept-encoding:gzip
```

Gzip 压缩是服务器的工作，开启 gzip 压缩后会启动自己的 cpu 去完成这个任务，会损耗服务器的性能。Webpack 中 Gzip 压缩操作的存在，事实上就是为了在构建过程中去做一部分服务器的工作，为服务器分压

- 图片

兼顾体积，选取合适的图片格式和分辨率

- 尽量控制 cookie 大小

每次请求会携带同域名下的所有 cookie

- cdn

内容分发网络指的是一组分布在各个地区的服务器，cdn 预热是指将原站的内容分发到各个地区的 cdn 节点上，cdn 刷新指当原站内容更新时强制去拉取最新的内容。如果没有进行 cdn 预热，大流量的请求会直接到原站服务器上，可能会导致崩溃

cdn 域名和业务域名是不同的，是为了防止请求 cdn 资源时携带与业务域名同源的 cookie

#### 浏览器层面

- 浏览器缓存

缓存可以减少网络 IO 消耗，提高访问速度

- ssr

服务端渲染，由服务端生成 HTML 字符串返回给客户端，可以进行页面的缓存，有利于 seo 优化，因为输出的 HTML 是有内容的

- 预加载

dns 预解析

```html
<link rel="dns-prefetch" />
```

图片预加载

```html
<link rel="preload" as="image" href="..." />
```

#### 5 层网络模型

服务端和客户端都存在五层网络模型

- 物理层：定义物理设备如何传输数据，就是电脑的硬件，如网卡端口

- 数据链路层：负责封装和解封装 IP 报文，发送和接受 ARP/RARP 报文等

- 网络层：负责路由以及把分组报文发送给目标网络或主机

- 传输层：负责对报文进行分组和重组，并以 TCP 或 UDP 协议格式封装报文。在我的电脑和服务器建立连接后，用来定义数据传输的方式

- 应用层：负责向用户提供应用程序，比如 HTTP、FTP、Telnet、DNS、SMTP 等

![](./assets/网络模型.png)

#### http 协议发展历史

1. http0.9

- 只有一个请求方式 get，没有 header 等描述数据信息

- 服务器发送完毕后，就关闭 TCP 连接

2. http1.0

- 增加了 post 等请求方式，增加了 status code 和 header，status code 用来描述服务端处理请求后的状态，header 用来描述请求和响应的数据信息

3. http1.1

- 持久连接，在 http1.0 中，每发送一个 http 请求，就要在客户端和服务端之间创建一个 TCP 连接，服务端响应后就会关闭，创建这样的连接成本比较高，http1.1 中避免了这样的问题

- pipeline，一个 TCP 连接可以发送多个 http 请求，服务端接收到这些请求后顺序接收，但是存在的问题是，如果前一个请求耗时较长会影响后一个请求的接收

- 增加 header 的一些描述信息，如 host

4. http2

- 所有数据通过二进制进行传输，而 http1.1 中大多数以字符串的形式传输。所有的数据以帧的形式进行传输

- 同一个 TCP 连接发送多个请求不需要再顺序返回，并行处理

- header 信息压缩，每次请求和响应都会携带 header，压缩 header 可以提升传输效率

- 推送，服务端也可以主动推送数据给客户度

> 需要注意的是，http 请求是建立在 TCP 连接之上的，TCP 建立连接时要经历三次握手才能发送 http 请求

#### URI

URI：统一资源标志符，包括 URL 和 URN，用来唯一标识互联网中的信息资源

URL；统一资源定位器，用来定位到某一个物理服务器中某个端口下的资源

URN：永久统一资源定位符，资源移动后还能被找到

#### http 报文

![](./http报文.png)

请求报文格式

- 起始行，即图中的 GET /test/hi-there.txt HTTP/1.0，包括请求方式、资源的 url、http 协议版本

- 请求头

响应报文格式

- 起始行，即图中的 HTTP/1.0 200 OK，包括 http 协议版本、状态码、状态码具体含义

- 响应头

- 主体部分，与响应头以一个空行间隔

#### https

http 明文传输，在传输过程中任何人都有可能从中截获、修改或者伪造请求发送，是不安全的。HTTPS 是 HTTP 协议的一种扩展，使用传输层安全性(TLS)或安全套接字层(SSL)对通信协议进行加密，也就是 HTTP + SSL(TLS) = HTTPS

![](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/3/14/170d6eaf0abec4e7~tplv-t2oaga2asx-zoom-in-crop-mark:1304:0:0:0.awebp)

HTTPS 协议其实非常简单，默认端口号 443，应答模式、报文结构、请求方法、URI、头字段、连接管理等等都完全沿用 HTTP

##### TLS 和 SSL

SSL（安全套接字层），1999 年被 IETF(互联网工程组)更名为 TLS （传输安全层），TLS 由记录协议、握手协议、警告协议、变更密码规范协议、扩展协议等几个子协议组成，综合使用了对称加密、非对称加密、身份认证等技术

##### 对称加密

对称加密是指加密和解密时使用的密钥都是同样的密钥，需要保证密钥足够安全，但加密解密双方在传输密钥的过程中可能会泄漏，是不安全的

![](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/3/14/170d6eaf178d5797~tplv-t2oaga2asx-zoom-in-crop-mark:1304:0:0:0.awebp)

###### 非对称加密

##### https 通信过程
